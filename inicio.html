<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>MadSulu GO - Selección de series</title>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      background: radial-gradient(ellipse at center, #0a0a0a 0%, #121b2b 100%);
      color: #e0ffe0;
    }

    header {
      text-align: center;
      padding: 1rem;
    }

    header img {
      max-width: 250px;
      height: auto;
    }

    h2 {
      margin: 1rem 0 0.5rem 1rem;
      font-size: 1.3rem;
      font-weight: bold;
      color: #ffffff;
      text-shadow: 0 0 6px rgba(255, 255, 255, 0.6), 0 0 12px rgba(150, 150, 150, 0.4);
    }

    .categoria { margin-bottom: 2rem; }

    .scroll-row {
      display: flex;
      overflow-x: auto;
      padding: 0 1rem;
      gap: 1rem;
    }

    .scroll-row::-webkit-scrollbar { height: 8px; }
    .scroll-row::-webkit-scrollbar-thumb {
      background: rgba(255,255,255,0.08);
      border-radius: 4px;
    }

    .serie {
      position: relative;
      flex: 0 0 auto;
      width: 156px;
      border-radius: 16px;
      overflow: hidden;
      background-color: #222;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
      cursor: pointer;
      transition: transform 0.25s ease, box-shadow 0.25s ease;
    }

    .serie:hover {
      transform: scale(1.05);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.6);
    }

    .serie img {
      width: 100%;
      height: 101px;
      object-fit: cover;
      display: block;
    }

    .info { padding: 0.4rem; background: #111; }

    .info .nombre {
      font-weight: bold;
      font-size: 0.95rem;
      color: #fff;
    }

    .info .edad { font-size: 0.85rem; color: #bbb; }

    .proximamente { opacity: 0.5; cursor: not-allowed; }
    .proximamente .info::after {
      content: "PRÓXIMAMENTE";
      display: block;
      color: #f88;
      font-weight: bold;
      margin-top: 0.3rem;
    }

    .banner {
      position: relative;
      width: 100%;
      max-width: 600px;
      height: 200px;
      margin: 20px auto;
      border-radius: 20px;
      overflow: hidden;
      background-size: cover;
      background-position: center;
      display: flex;
      align-items: center;
      padding: 30px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5);
    }

    .banner h2 { margin: 0 0 15px; font-size: 24px; text-shadow: 1px 1px 3px rgba(0,0,0,0.6); }
    .banner a { display: inline-block; padding: 8px 16px; border: 2px solid white; border-radius: 10px; text-decoration: none; color: white; font-size: 16px; transition: all 0.3s ease; }
    .banner a:hover { background: white; color: #111; }

    /* Buscador */
    .buscador-container {
      position: relative;
      max-width: 520px;
      margin: 15px auto;
      padding: 0 1rem;
    }

    #buscador {
      width: 100%;
      padding: 10px 12px;
      border-radius: 8px;
      border: none;
      font-size: 16px;
      outline: none;
      background: rgba(255,255,255,0.04);
      color: #fff;
      box-shadow: 0 2px 8px rgba(0,0,0,0.5);
    }

    .sugerencias {
      position: absolute;
      top: calc(100% + 8px);
      left: 0;
      right: 0;
      background: #0b0b0b;
      border: 1px solid #444;
      border-radius: 8px;
      max-height: 240px;
      overflow-y: auto;
      display: none;
      z-index: 30;
      box-shadow: 0 8px 24px rgba(0,0,0,0.6);
    }

    .sugerencia {
      padding: 10px 12px;
      cursor: pointer;
      color: #fff;
      border-bottom: 1px solid rgba(255,255,255,0.03);
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .sugerencia:last-child { border-bottom: none; }
    .sugerencia:hover { background: rgba(255,255,255,0.03); }

    .sugerencia .mini {
      width: 56px;
      height: 36px;
      object-fit: cover;
      border-radius: 6px;
      flex-shrink: 0;
      border: 1px solid rgba(255,255,255,0.04);
    }

    .sugerencias.show { display: block; animation: desplegar 350ms ease; transform-origin: top center; }
    @keyframes desplegar {
      0% { transform: scaleY(0.6); opacity: 0; }
      60% { transform: scaleY(1.03); opacity: 1; }
      100% { transform: scaleY(1); opacity: 1; }
    }
  </style>
</head>
<body>

<header>
  <img src="https://files.catbox.moe/q8rwdm.png" alt="MadSulu GO Logo">
</header>

<!-- Buscador con ruleta de sugerencias -->
<div class="buscador-container" aria-hidden="false">
  <input type="search" id="buscador" placeholder="Buscar serie..." aria-label="Buscar serie">
  <div id="sugerencias" class="sugerencias" role="listbox" aria-label="Sugerencias de series"></div>
</div>

<!-- Nota: Mensaje ganador eliminado por petición del usuario -->

<!-- Has visto recientemente -->
<div class="categoria">
  <h2>👀 Has visto recientemente</h2>
  <div class="scroll-row" id="recientes-list" style="padding: 0 1rem;"></div>
  <div style="max-width:520px;margin:8px auto;text-align:right;padding-right:1rem;">
    <button id="clearRecientes" type="button" style="padding:6px 10px;border-radius:8px;border:none;cursor:pointer;background:#222;color:#fff;">Limpiar</button>
  </div>
</div>

<!-- CATEGORÍAS Y SERIES (se mantiene el contenido visual que tenías) -->
<div class="categoria">
  <h2>🏆 MadSulu GO Cup</h2>
  <div class="scroll-row">
    <div class="serie" onclick="location.href='las-fumadas-de-famil.html'">
      <img src="https://files.catbox.moe/1axsuw.jpg" alt="Las Fumadas de Famil">
      <div class="info"><div class="nombre">Las Fumadas de Famil</div><div class="edad">+10 años</div></div>
    </div>

    <div class="serie proximamente">
      <img src="https://files.catbox.moe/dgskst.png" alt="Pancho: El final">
      <div class="info"><div class="nombre">Pancho: El final</div><div class="edad">+7 años</div></div>
    </div>
  </div>
</div>

<!-- 🎮 Acción y aventuras -->
<div class="categoria">
  <h2>🎮 Acción y aventuras</h2>
  <div class="scroll-row">
    <div class="serie" onclick="location.href='pancho.html'">
      <img src="https://files.catbox.moe/bg7dhd.png" alt="Pancho" />
      <div class="info"><div class="nombre">Pancho</div><div class="edad">+7 años</div></div>
    </div>

    <div class="serie" onclick="location.href='conaco.html'">
      <img src="https://files.catbox.moe/zc0ht2.png" alt="Coñaco" />
      <div class="info"><div class="nombre">Coñaco</div><div class="edad">Adolescentes</div></div>
    </div>

    <div class="serie" onclick="location.href='demonic-legends.html'">
      <img src="https://files.catbox.moe/2qikmp.png" alt="Demonic Legends" />
      <div class="info"><div class="nombre">Demonic Legends</div><div class="edad">Adolescentes</div></div>
    </div>

    <div class="serie" onclick="location.href='countrytubers-multiverso.html'">
      <img src="https://files.catbox.moe/72hgd3.png" alt="CountryTubers Multiverso" />
      <div class="info"><div class="nombre">CountryTubers Multiverso</div><div class="edad">+7 años</div></div>
    </div>

    <div class="serie" onclick="location.href='las-fumadas-de-famil.html'">
      <img src="https://files.catbox.moe/1axsuw.jpg" alt="Las Fumadas de Famil" />
      <div class="info"><div class="nombre">Las Fumadas de Famil</div><div class="edad">+10 años</div></div>
    </div>

    <div class="serie proximamente">
      <img src="https://files.catbox.moe/dgskst.png" alt="Pancho: El final" />
      <div class="info"><div class="nombre">Pancho: El final</div><div class="edad">+7 años</div></div>
    </div>

    <div class="serie proximamente">
      <img src="https://files.catbox.moe/8tlgjo.png" alt="Venganza europea" />
      <div class="info"><div class="nombre">Venganza europea</div><div class="edad">+10 años</div></div>
    </div>

    <div class="serie proximamente">
      <img src="https://files.catbox.moe/apa50t.png" alt="The Fr13nDzH1p Tapes" />
      <div class="info"><div class="nombre">The Fr13nDzH1p Tapes</div><div class="edad">Adolescentes</div></div>
    </div>

    <div class="serie proximamente">
      <img src="https://files.catbox.moe/q56yqg.png" alt="Locura por el multiverso" />
      <div class="info"><div class="nombre">Locura por el multiverso</div><div class="edad">+10 años</div></div>
    </div>

    <div class="serie proximamente">
      <img src="https://files.catbox.moe/r5734h.png" alt="Oh dios: La película" />
      <div class="info"><div class="nombre">Oh dios: La película</div><div class="edad">Adolescentes</div></div>
    </div>

    <div class="serie proximamente">
      <img src="https://files.catbox.moe/uisvhx.png" alt="Joshua 2D Prime" />
      <div class="info"><div class="nombre">Joshua 2D Prime</div><div class="edad">+7 años</div></div>
    </div>
  </div>
</div>

<!-- 🌐 Universos extraños y fantasía -->
<div class="categoria">
  <h2>🌐 Universos extraños y fantasía</h2>
  <div class="scroll-row">
    <div class="serie" onclick="location.href='pancho.html'">
      <img src="https://files.catbox.moe/bg7dhd.png" alt="Pancho" />
      <div class="info"><div class="nombre">Pancho</div><div class="edad">+7 años</div></div>
    </div>

    <div class="serie" onclick="location.href='las-californias.html'">
      <img src="https://files.catbox.moe/0b1zji.png" alt="Las Californias" />
      <div class="info"><div class="nombre">Las Californias</div><div class="edad">+10 años</div></div>
    </div>

    <div class="serie" onclick="location.href='californias-classic.html'">
      <img src="https://files.catbox.moe/h8cro0.png" alt="CaliFornias Classic" />
      <div class="info"><div class="nombre">CaliFornias Classic</div><div class="edad">Todos</div></div>
    </div>

    <div class="serie" onclick="location.href='countrytubers-multiverso.html'">
      <img src="https://files.catbox.moe/72hgd3.png" alt="CountryTubers Multiverso" />
      <div class="info"><div class="nombre">CountryTubers Multiverso</div><div class="edad">+7 años</div></div>
    </div>

    <div class="serie" onclick="location.href='demonic-legends.html'">
      <img src="https://files.catbox.moe/2qikmp.png" alt="Demonic Legends" />
      <div class="info"><div class="nombre">Demonic Legends</div><div class="edad">Adolescentes</div></div>
    </div>

    <div class="serie proximamente">
      <img src="https://files.catbox.moe/rzgjof.jpg" alt="LAEF" />
      <div class="info"><div class="nombre">LAEF</div><div class="edad">Adolescentes</div></div>
    </div>

    <div class="serie proximamente">
      <img src="https://files.catbox.moe/prsupd.png" alt="Chetto: La serie" />
      <div class="info"><div class="nombre">Chetto: La serie</div><div class="edad">+7 años</div></div>
    </div>

    <div class="serie proximamente">
      <img src="https://files.catbox.moe/atnfkz.png" alt="Una película de Countryballs" />
      <div class="info"><div class="nombre">Una película de Countryballs</div><div class="edad">+10 años</div></div>
    </div>

    <div class="serie proximamente">
      <img src="https://files.catbox.moe/dgskst.png" alt="Pancho: El final" />
      <div class="info"><div class="nombre">Pancho: El final</div><div class="edad">+7 años</div></div>
    </div>
  </div>
</div>

<!-- 🤣 Comedias y parodias -->
<div class="categoria">
  <h2>🤣 Comedias y parodias</h2>
  <div class="scroll-row">
    <div class="serie" onclick="location.href='pancho.html'">
      <img src="https://files.catbox.moe/bg7dhd.png" alt="Pancho" />
      <div class="info"><div class="nombre">Pancho</div><div class="edad">+7 años</div></div>
    </div>

    <div class="serie" onclick="location.href='batalla-countrytuber.html'">
      <img src="https://files.catbox.moe/5ym1pj.png" alt="Batalla Countrytuber" />
      <div class="info"><div class="nombre">Batalla Countrytuber</div><div class="edad">+10 años</div></div>
    </div>

    <div class="serie" onclick="location.href='el-bebe-dinosaurio.html'">
      <img src="https://files.catbox.moe/wr6k3n.png" alt="El bebé dinosaurio" />
      <div class="info"><div class="nombre">El bebé dinosaurio</div><div class="edad">Todos</div></div>
    </div>

    <div class="serie" onclick="location.href='mjaja-series.html'">
      <img src="https://files.catbox.moe/ulh1ly.png" alt="MJaja Series" />
      <div class="info"><div class="nombre">MJaja Series</div><div class="edad">+10 años</div></div>
    </div>

    <div class="serie" onclick="location.href='las-fumadas-de-famil.html'">
      <img src="https://files.catbox.moe/1axsuw.jpg" alt="Las Fumadas de Famil" />
      <div class="info"><div class="nombre">Las Fumadas de Famil</div><div class="edad">+10 años</div></div>
    </div>

    <div class="serie" onclick="location.href='countrytubers-multiverso.html'">
      <img src="https://files.catbox.moe/72hgd3.png" alt="CountryTubers Multiverso" />
      <div class="info"><div class="nombre">CountryTubers Multiverso</div><div class="edad">+7 años</div></div>
    </div>

    <div class="serie proximamente">
      <img src="https://files.catbox.moe/38wwos.png" alt="Chulin's Adventure Mania" />
      <div class="info"><div class="nombre">Adventure Mania</div><div class="edad">Todos</div></div>
    </div>

    <div class="serie proximamente">
      <img src="https://files.catbox.moe/m6uc4r.png" alt="Viajes con Chulin" />
      <div class="info"><div class="nombre">Viajes con Chulin</div><div class="edad">Todos</div></div>
    </div>
  </div>
</div>

<!-- 󰔡 MadSulu Kids -->
<div class="categoria">
  <h2>󰔡 MadSulu Kids</h2>
  <div class="scroll-row">
    <div class="serie" onclick="location.href='pancho.html'">
      <img src="https://files.catbox.moe/bg7dhd.png" alt="Pancho" />
      <div class="info"><div class="nombre">Pancho</div><div class="edad">+7 años</div></div>
    </div>

    <div class="serie" onclick="location.href='las-californias.html'">
      <img src="https://files.catbox.moe/0b1zji.png" alt="Las Californias" />
      <div class="info"><div class="nombre">Las Californias</div><div class="edad">+10 años</div></div>
    </div>

    <div class="serie" onclick="location.href='californias-classic.html'">
      <img src="https://files.catbox.moe/h8cro0.png" alt="CaliFornias Classic" />
      <div class="info"><div class="nombre">CaliFornias Classic</div><div class="edad">Todos</div></div>
    </div>

    <div class="serie" onclick="location.href='el-bebe-dinosaurio.html'">
      <img src="https://files.catbox.moe/wr6k3n.png" alt="El bebé dinosaurio" />
      <div class="info"><div class="nombre">El bebé dinosaurio</div><div class="edad">Todos</div></div>
    </div>

    <div class="serie" onclick="location.href='mjaja-series.html'">
      <img src="https://files.catbox.moe/ulh1ly.png" alt="MJaja Series" />
      <div class="info"><div class="nombre">MJaja Series</div><div class="edad">+10 años</div></div>
    </div>

    <div class="serie proximamente">
      <img src="https://files.catbox.moe/prsupd.png" alt="Chetto: La serie" />
      <div class="info"><div class="nombre">Chetto: La serie</div><div class="edad">+7 años</div></div>
    </div>

    <div class="serie proximamente">
      <img src="https://files.catbox.moe/uisvhx.png" alt="Joshua 2D Prime" />
      <div class="info"><div class="nombre">Joshua 2D Prime</div><div class="edad">+7 años</div></div>
    </div>
  </div>
</div>

<!-- 🎨 Creador a creador -->
<div class="categoria">
  <h2>🎨 Creador a creador</h2>
  <div class="scroll-row">
    <div class="serie" onclick="location.href='dimoxtube.html'">
      <img src="https://files.catbox.moe/rlxo4n.png" alt="Dimoxtube" />
      <div class="info"><div class="nombre">Dimoxtube</div><div class="edad">-</div></div>
    </div>
  </div>
</div>

<script>
  (function(){
    // KEY usada por el selector de perfiles (si otra pantalla la guarda)
    const ACTIVE_KEY = 'madsulu_active_profile';

    // Helper para obtener perfil activo guardado en localStorage (objeto)
    function getActiveProfile() {
      try {
        const raw = localStorage.getItem(ACTIVE_KEY);
        if (!raw) return null;
        return JSON.parse(raw);
      } catch (e) {
        console.warn('Error parseando ACTIVE_KEY', e);
        return null;
      }
    }

    // Devuelve la clave de recientes para el usuario actual (o guest)
    function recientesKeyForActive() {
      const active = getActiveProfile();
      if (!active) return 'madsulu_recientes_guest';
      // usamos índice cuando exista (más estable); si no, usamos nombre sanitizado
      const id = (typeof active.index === 'number') ? ('idx' + active.index) : ('name_' + String(active.name || 'unk').replace(/\s+/g,'_'));
      return 'madsulu_recientes_' + id;
    }

    // Helper: obtén la lista global de series
    function getAllSeries(){
      try{
        if (typeof series !== 'undefined' && Array.isArray(series)) return series;
      }catch(e){}
      if (window.series && Array.isArray(window.series)) return window.series;
      if (window._series && Array.isArray(window._series)) return window._series;
      return [];
    }

    // Convierte un nombre de serie/ref en nombre de archivo .html (mismo algoritmo usado en el HTML estático)
    function refToFilename(ref) {
      const s = (series && Array.isArray(series)) ? series.find(x => x.ref === ref) : null;
      if (s && s.nombre) {
        const normalized = s.nombre
          .toLowerCase()
          .normalize('NFD').replace(/[\u0300-\u036f]/g, '') // quitar acentos
          .replace(/[^a-z0-9]+/g, '-') // no alfanum -> guion
          .replace(/^-+|-+$/g, ''); // trim guiones
        return normalized + '.html';
      }
      // casos especiales
      if (ref === 'shorts') return 'shorts.html';
      if (ref === 'IDI4') return 'descripcion.html';
      return ref + '.html';
    }

    // Añade un ref a los recientes **del usuario activo**
    function addToRecientes(ref){
      try{
        const all = getAllSeries();
        const s = (all.find ? all.find(x => x.ref === ref) : undefined) || { nombre: ref, img: '' };
        const key = recientesKeyForActive();
        let arr = JSON.parse(localStorage.getItem(key) || '[]');
        // eliminar duplicados
        arr = arr.filter(a => a.ref !== ref);
        // añadir al inicio (guardamos también nombre e imagen actuales si existen)
        arr.unshift({ ref: s.ref || ref, nombre: s.nombre || ref, img: s.img || '', ts: Date.now() });
        // limitar a 8 items
        if (arr.length > 8) arr = arr.slice(0,8);
        localStorage.setItem(key, JSON.stringify(arr));
        renderRecientes(); // refrescar en pantalla
      } catch (e) {
        console.warn('Error guardando recientes', e);
      }
    }

    // Render de los recientes del usuario activo
    function renderRecientes(){
      const container = document.getElementById('recientes-list');
      if (!container) return;
      const key = recientesKeyForActive();
      const arr = JSON.parse(localStorage.getItem(key) || '[]');
      container.innerHTML = '';
      if (!arr.length) {
        // Si hay perfil activo mostramos mensaje personalizado
        const active = getActiveProfile();
        const quien = active ? (active.name || 'este usuario') : 'este dispositivo (invitado)';
        container.innerHTML = '<p style="color:#bbb;padding:12px">No has visto nada recientemente para ' + quien + '.</p>';
        return;
      }
      const all = getAllSeries();
      arr.forEach(item => {
        // intenta completar nombre/img usando la lista de series si falta o es genérico
        const match = (all.find ? all.find(s => s.ref === item.ref) : undefined) || {};
        const nombre = match.nombre || item.nombre || item.ref;
        const img = match.img || item.img || 'https://files.catbox.moe/bg7dhd.png';

        const div = document.createElement('div');
        div.className = 'serie';
        div.style.width = '140px';
        div.style.marginRight = '10px';
        div.onclick = () => { window.location.href = refToFilename(item.ref); };
        div.innerHTML = '<img src="'+img+'" alt="'+nombre+'">'+
                        '<div class="info"><div class="nombre">'+nombre+'</div></div>';
        container.appendChild(div);
      });
    }

    // Limpiar los recientes **del usuario activo**
    function clearRecientesActive() {
      const key = recientesKeyForActive();
      localStorage.removeItem(key);
      renderRecientes();
    }

    // Inicializar
    document.addEventListener('DOMContentLoaded', () => {
      renderRecientes();

      const clearBtn = document.getElementById('clearRecientes');
      if (clearBtn) clearBtn.addEventListener('click', () => {
        if (confirm('¿Limpiar el historial reciente de este usuario?')) clearRecientesActive();
      });

      // Exponer addToRecientes y renderRecientes por si se quiere usar manualmente desde consola u otros scripts
      window.addToRecientes = addToRecientes;
      window.renderRecientes = renderRecientes;
    });

    // Si otro script (por ejemplo la pantalla de selección de perfil) cambia el perfil activo,
    // escuchamos storage para detectar cambios en ACTIVE_KEY y actualizar la lista.
    window.addEventListener('storage', (ev) => {
      if (ev.key === ACTIVE_KEY) {
        // perfil cambiado en otra pestaña/ventana; refrescar recientes
        renderRecientes();
      }
    });

    // También, si la app cambia localStorage en la misma pestaña (sin evento storage),
    // podemos observar periódicamente la clave para detectar cambios y actualizar UI.
    let lastActiveRaw = localStorage.getItem(ACTIVE_KEY);
    setInterval(() => {
      const nowRaw = localStorage.getItem(ACTIVE_KEY);
      if (nowRaw !== lastActiveRaw) {
        lastActiveRaw = nowRaw;
        renderRecientes();
      }
    }, 800);

  })();
</script>

<!-- SHORTS BANNER -->
<div class="banner" style="background: linear-gradient(120deg, rgba(255,69,0,0.6), rgba(142,45,226,0.6)), url('https://files.catbox.moe/6ql4b0.gif') center/cover no-repeat;">
  <div style="z-index: 2;">
    <h2>descubre <br>madsulu fast momentos rapidos de series.</h2>
    <a href="#" class="shorts-link" onclick="location.href='shorts.html'; return false;">Ir a Shorts</a>
  </div>
</div>

<!-- INFO CREADORES BANNER -->
<div class="banner" style="background: linear-gradient(120deg, rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url('https://files.catbox.moe/9wwyaq.png') center/cover no-repeat;">
  <div style="z-index: 2;">
    <h2>Mira la información<br>de nuestros creadores.</h2>
    <a href="#" onclick="location.href='descripcion.html'; return false;">ver descripcion</a>
  </div>
</div>

<script>
  // Lista completa de series para el buscador (la misma que antes)
  const series = [
    { nombre: "Pancho", ref: "pls", img: "https://files.catbox.moe/bg7dhd.png" },
    { nombre: "Las Fumadas de Famil", ref: "lff", img: "https://files.catbox.moe/1axsuw.jpg" },
    { nombre: "Coñaco", ref: "cn", img: "https://files.catbox.moe/zc0ht2.png" },
    { nombre: "Demonic Legends", ref: "dlr", img: "https://files.catbox.moe/2qikmp.png" },
    { nombre: "CountryTubers Multiverso", ref: "ctm", img: "https://files.catbox.moe/72hgd3.png" },
    { nombre: "Las Californias", ref: "lc", img: "https://files.catbox.moe/0b1zji.png" },
    { nombre: "CaliFornias Classic", ref: "lcc", img: "https://files.catbox.moe/h8cro0.png" },
    { nombre: "Batalla Countrytuber", ref: "btc", img: "https://files.catbox.moe/5ym1pj.png" },
    { nombre: "El bebé dinosaurio", ref: "ebd", img: "https://files.catbox.moe/wr6k3n.png" },
    { nombre: "MJaja Series", ref: "MJa", img: "https://files.catbox.moe/ulh1ly.png" },
    { nombre: "Dimoxtube", ref: "dt", img: "https://files.catbox.moe/rlxo4n.png" },
    { nombre: "Pancho: El final", ref: "pf", img: "https://files.catbox.moe/dgskst.png" },
    { nombre: "Venganza europea", ref: "ve", img: "https://files.catbox.moe/8tlgjo.png" },
    { nombre: "The Fr13nDzH1p Tapes", ref: "fr", img: "https://files.catbox.moe/apa50t.png" },
    { nombre: "Locura por el multiverso", ref: "lpm", img: "https://files.catbox.moe/q56yqg.png" },
    { nombre: "Oh dios: La película", ref: "od", img: "https://files.catbox.moe/r5734h.png" },
    { nombre: "Joshua 2D Prime", ref: "j2p", img: "https://files.catbox.moe/uisvhx.png" },
    { nombre: "LAEF", ref: "laef", img: "https://files.catbox.moe/rzgjof.jpg" },
    { nombre: "Chetto: La serie", ref: "chetto", img: "https://files.catbox.moe/prsupd.png" },
    { nombre: "Una película de Countryballs", ref: "cbmov", img: "https://files.catbox.moe/atnfkz.png" },
    { nombre: "Adventure Mania", ref: "advm", img: "https://files.catbox.moe/38wwos.png" },
    { nombre: "Viajes con Chulin", ref: "vch", img: "https://files.catbox.moe/m6uc4r.png" }
  ];

  const buscador = document.getElementById('buscador');
  const sugerencias = document.getElementById('sugerencias');

  function renderSugerencias(matches) {
    sugerencias.innerHTML = '';
    matches.forEach((s, i) => {
      const div = document.createElement('div');
      div.className = 'sugerencia';
      div.setAttribute('role', 'option');
      div.setAttribute('aria-selected', 'false');
      div.tabIndex = 0;
      div.onclick = () => { window.location.href = refToFilename(s.ref); };
      div.onkeydown = (e) => { if (e.key === 'Enter') window.location.href = refToFilename(s.ref); };
      const img = document.createElement('img');
      img.src = s.img;
      img.alt = s.nombre;
      img.className = 'mini';
   
      const span = document.createElement('div');
      span.textContent = s.nombre;
      div.appendChild(img);
      div.appendChild(span);
      sugerencias.appendChild(div);
    });
    if (matches.length) sugerencias.classList.add('show');
    else sugerencias.classList.remove('show');
  }

  buscador.addEventListener('input', () => {
    const query = buscador.value.trim().toLowerCase();
    if (!query) { sugerencias.classList.remove('show'); return; }
    const matches = series.filter(s => s.nombre.toLowerCase().includes(query));
    renderSugerencias(matches);
  });

  buscador.addEventListener('focus', () => {
    const top = series.slice(0, 6);
    renderSugerencias(top);
  });

  document.addEventListener('click', (e) => {
    const inside = document.querySelector('.buscador-container').contains(e.target);
    if (!inside) sugerencias.classList.remove('show');
  });

  // refToFilename ya definido más arriba; la función se vuelve a declarar aquí para que esté disponible
  function refToFilename(ref) {
    const s = (series && Array.isArray(series)) ? series.find(x => x.ref === ref) : null;
    if (s && s.nombre) {
      const normalized = s.nombre
        .toLowerCase()
        .normalize('NFD').replace(/[\u0300-\u036f]/g, '')
        .replace(/[^a-z0-9]+/g, '-')
        .replace(/^-+|-+$/g, '');
      return normalized + '.html';
    }
    if (ref === 'shorts') return 'shorts.html';
    if (ref === 'IDI4') return 'descripcion.html';
    return ref + '.html';
  }

  // Cuando el usuario escribe o selecciona sugerencia, navegamos al archivo HTML correspondiente.
</script>

</body>
</html>
